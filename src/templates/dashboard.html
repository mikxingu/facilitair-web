{% extends "layout.html" %}

{% block content%}
<select class="ui selection dropdown" name="tickers" id="in_ticker">
  {% for stock in all_stocks %}
    <option value={{stock}} id="in_stock">{{stock}}</option>
  {% endfor %}
</select>

<div class="ui input">
  <input type="number" placeholder="Quantidade" id="in_quantity" required="true">
</div>

<div class="ui input">
  <input type="number" placeholder="Preco Medio" id="in_average" required="false">
</div>
<div>

  <div>
    <button class="ui icon button" id="add_stock">
      <script>
        $(document).ready(function(){
          
          $("#add_stock").click(function() {
            
            var stock_selected = document.getElementById("in_ticker");
            var ticker = stock_selected.value;

            var quantity = document.getElementById("in_quantity").value;
            var average = document.getElementById("in_average").value;
            
          

            var result;

          $.ajax({
            type: "GET",
            url: '/stock/'+ticker,
            datatype: "json",
            async: false,
            success: function(data){
              result = data;      
            }
          });

          let cnpj = result[0]

          let companyName = result[1]
          
          let year_close = result[2]
            // var information = null;
            
            // $.get('/stock/'+ticker,  // url
            //   function (data, textStatus, jqXHR) {  // success callback
                
            //     cnpj = data[0]
            //     companyName = data[1]
            //     year_close = data[2]
            //     information = data
            //     return information
            // });

            // console.log(information)

            var description = quantity + " ACOES "+ companyName + "COM PRECO MEDIO DE "+ average + " POR ACAO."
            
            var markup = 
            "<tr><td><input type='checkbox' id='test' class='completed'></td><td>" + ticker + 
              "</td><td>" + companyName + "</td><td>" + quantity + "</td><td>" + average + 
              "</td><td>" + cnpj + "</td><td>" + description + "</td><td>" + year_close + "</td>"
                "</tr>";
            $("table tbody").append(markup);
          })
        });
      </script>
      <i class="plus icon"></i>
    </button>
  </div>
  
<table class="ui celled table" id="stocks">
    <thead>
      <tr>
        <th>Lançado</th>
        <th>Ticker</th>
        <th>Razao Social</th>
        <th>Quantidade</th>
        <th>Preço médio</th>
        <th>CNPJ</th>
        <th>Discriminação</th>
        <th>Preço de fechamento Anual</th>
    </tr>
  </thead>
    <tbody>
      <!--
      <tr>
        <td data-label="Lançado" bgcolor="silver"><input type="checkbox" id="currentstock" name="completed" checked="true"/></td>
        <td data-label="Ticker" bgcolor="silver">OIBR3</td>
        <td data-label="RazaoSocial" bgcolor="silver">OI S.A.</td>
        <td data-label="Quantidade" bgcolor="silver">20500</td>
        <td data-label="PrecoMedio" bgcolor="silver">0.94</td>
        <td data-label="CNPJ" bgcolor="silver">76.535.764/0001-43<button class="ui button"><i class="animated fade clipboard icon"></i></button></td>
        <td data-label="Discriminação" bgcolor="silver">{QUANTIDADE} ACOES {RAZAO_SOCIAL} COM PRECO MEDIO DE {PM} POR ACAO <button class="ui button"><i class="animated fade clipboard icon"></i></button></td>
        <td data-label="YearClose" bgcolor="silver">0.76</td>
      </tr>
      
      <tr>
        <td data-label="Lançado"><input type="checkbox" name="lançado"/> </td>
        <td data-label="Name">TAEE3</td>
        <td data-label="Age">12.12</td>
        <td data-label="Job">07.859.971/0001-30</td>
      </tr>
      <tr>
        <td data-label="Lançado" bgcolor="silver"><input type="checkbox" id="currentstock" name="completed" checked="true"/></td>
        <td data-label="Ticker" bgcolor="silver">SANB3</td>
        <td data-label="RazaoSocial" bgcolor="silver">BANCO SANTANDER (BRASIL) S.A.</td>
        <td data-label="Quantidade" bgcolor="silver">1000</td>
        <td data-label="PrecoMedio" bgcolor="silver">13.50</td>
        <td data-label="CNPJ" bgcolor="silver">90.400.888/0001-42<button class="ui button"><i class="animated fade clipboard icon"></i></button></td>
        <td data-label="Discriminação" bgcolor="silver">{QUANTIDADE} ACOES {RAZAO_SOCIAL} COM PRECO MEDIO DE {PM} POR ACAO <button class="ui button"><i class="animated fade clipboard icon"></i></button></td>
        <td data-label="YearClose" bgcolor="silver">14.21</td>
      </tr>
      -->
    </tbody>
  </table>
{% endblock%}